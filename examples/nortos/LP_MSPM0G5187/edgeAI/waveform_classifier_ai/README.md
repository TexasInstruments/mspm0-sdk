## Example Summary

This example demonstrates time series classification of waveform signals into one of three categories: sawtooth wave, sine wave, or square wave. This example uses an ADC to capture the input waveform, from which features are extracted using the feature_extract library. The extracted features are fed into the model for inference, and the model's output is used to activate the appropriate LED for each waveform type. The model was trained and validated using an input waveform with a frequency of 300 Hz and a DC offset of 1.65V.

A compact and modular Convolutional Neural Network (CNN) with 14,124 parameters is used for classification. The model is designed to handle multivariate input signals and supports multi-class classification.

In the PyTorch training framework, neural networks are trained with optimizations (for example, aggressive quantization) that target TI MCUs. After training, the neural networks are compiled by the 'TI Neural Network Compiler' (https://software-dl.ti.com/mctools/nnc/mcu/users_guide/index.html). Options passed to the compiler determine which of the following actions the generated inference library performs:
1. Hardware accelerated inference using a Neural network Processing Unit (NPU).
2. Software-only inference using the CPU on the MCU.

This example is built for the Software only inference mode using the CPU on MSPM0.

The output from the TI Neural Network Compiler is an artifacts directory that will contain: A header file (for example, tvmgen_default.h), and a library file (for example, model.a). This makes the output from the compiler easier to integrate with the project.

In the header file generated by the compiler (tvmgen_default.h) and stored in the artifacts directory, information about input/output data shapes and types is provided,
and input/output data structures and the inference function are defined.
 
## Peripherals, Pin Functions, MCU Pins, Launchpad Pins
| Peripheral | Function | MCU Pin | Launchpad Pin | Launchpad Settings |
| --- | --- | --- | --- | --- |
| GPIOA | Standard with Wake Output | PA17 | LED2 Red | Populate Jumper(s): J12[2:1] |
| GPIOA | Standard Output with internal pull-up | PA24 | LED2 Green | Populate Jumper(s): J13[2:1] |
| GPIOB | Standard Output | PB13 | LED2 Blue | Populate Jumper(s): J11[2:1] |
| SYSCTL |  |  |  |  |
| ADC0 | ADC12 Channel 5 Pin | PB24 | J2_18 |  |
| EVENT |  |  |  |  |
| BOARD | Debug Clock | PA20 | J101_16 |  |
| BOARD | Debug Data In Out | PA19 | J101_14 |  |

## BoosterPacks, Board Resources & Jumper Settings

Visit [LP_MSPM0G5187](https://www.ti.com/tool/LP-MSPM0G5187) for LaunchPad information, including user guide and hardware files.

| Pin | Peripheral | Function | LaunchPad Pin | LaunchPad Settings |
| --- | --- | --- | --- | --- |
| PB24 | ADC0 | A0 | J2_18 |  |
| PA17 | GPIOA | PA17 | J12_1 | <ul><li>PA17 can be connected to LED2 Red <ul><li>`J12 ON` Connect to LED2 Red <li>`J12 OFF` Disconnect from LED2 Red</ul></ul> |
| PA24 | GPIOA | PA24 | J13_1 | <ul><li>PA24 can be connected to LED2 Green <ul><li>`J13 ON` Connect to LED2 Green <li>`J13 OFF` Disconnect from LED2 Green</ul></ul> |
| PB13 | GPIOB | PB13 | J11_1 | <ul><li>PB13 can be connected to LED2 Blue <ul><li>`J11 ON` Connect to LED2 Green <li>`J11 OFF` Disconnect from LED2 Green</ul></ul> |
| PA20 | DEBUGSS | SWCLK | N/A | <ul><li>PA20 is used by SWD during debugging<br><ul><li>`J101 15:16 ON` Connect to XDS-110 SWCLK while debugging<br><li>`J101 15:16 OFF` Disconnect from XDS-110 SWCLK if using pin in application</ul></ul> |
| PA19 | DEBUGSS | SWDIO | N/A | <ul><li>PA19 is used by SWD during debugging<br><ul><li>`J101 13:14 ON` Connect to XDS-110 SWDIO while debugging<br><li>`J101 13:14 OFF` Disconnect from XDS-110 SWDIO if using pin in application</ul></ul> |

### Device Migration Recommendations
This project was developed for a superset device included in the MSPM0 LaunchPad. Please
visit the [CCS User's Guide](https://software-dl.ti.com/msp430/esd/MSPM0-SDK/latest/docs/english/tools/ccs_ide_guide/doc_guide/doc_guide-srcs/ccs_ide_guide.html#sysconfig-project-migration)
for information about migrating to other MSPM0 devices.

### Low-Power Recommendations
TI recommends to terminate unused pins by setting the corresponding functions to
GPIO and configure the pins to output low or input with internal
pullup/pulldown resistor.

SysConfig allows developers to easily configure unused pins by selecting **Board**â†’**Configure Unused Pins**.

For more information about jumper configuration to achieve low-power using the
MSPM0 LaunchPad, please visit the LP-MSPM0G5187 User's Guide.

## Example Usage
Compile, load and run the example.
Provide the input waveform to pin PA27.
The corresponding LED will illuminate to indicate the classified waveform type:
1. Red LED : Sawtooth Wave
2. Blue LED : Sinusoidal Wave
3. Green LED : Square Wave

The Blue LED also acts as a default for any other input shape.

Note: The model was trained and tested exclusively with an input wave frequency of 300Hz and a DC offset of 1.65V. Performance with other frequencies and offsets may not be accurate.

## References

- MSPM0G5187 Technical Reference Manual [Link](https://www.ti.com/product/MSPM0G5187)
- [TI Neural Network Compiler Guide](https://software-dl.ti.com/mctools/nnc/mcu/users_guide/)
- TI Model Training Guide: [tinyml-tensorlab](https://github.com/TexasInstruments/tinyml-tensorlab/tree/main)
- EdgeAI Software Guide: SDK_INSTALL_DIR/docs/english/middleware/edgeAI/MSPM0_EdgeAI_User_Guide.html