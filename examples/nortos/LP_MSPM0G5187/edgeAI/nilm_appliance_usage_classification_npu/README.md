## Example Summary

This example demonstrates a basic non-intrusive load monitoring (NILM) appliance usage classification. This example uses pre defined dataset to classify the type of load. The features are extracted for the test data using the feature_extract library. The extracted features are fed into the model for inference, and the model's output is used to activate the appropriate LED for each class of loads. The model was trained and validated for 3 classes of load +fridge, +fridge+tumble_dryer+washer_dryer, +fridge+washing_machine+washer_dryer. 

A compact and modular Convolutional Neural Network (CNN) with 14,124 parameters is used for classification. The model is designed to handle multivariate input signals and supports multi-class classification.

This example is built for the Hardware accelerated inference using a Neural network Processing Unit (NPU).

The output from the TI Neural Network Compiler is an artifacts directory that will contain: A header file (for example, tvmgen_default.h), and a library file (for example, model.a). This makes the output from the compiler easier to integrate with the project.

In the header file generated by the compiler (tvmgen_default.h) and stored in the artifacts directory, information about input/output data shapes and types is provided,
and input/output data structures and the inference function are defined.
 
## Peripherals, Pin Functions, MCU Pins, Launchpad Pins
| Peripheral | Function | MCU Pin | Launchpad Pin | Launchpad Settings |
| --- | --- | --- | --- | --- |
| GPIOA | Standard with Wake Output | PA17 | LED2 Red | Populate Jumper(s): J12[2:1] |
| GPIOA | Standard Output with internal pull-up | PA24 | LED2 Green | Populate Jumper(s): J13[2:1] |
| GPIOB | Standard Output | PB13 | LED2 Blue | Populate Jumper(s): J11[2:1] |
| SYSCTL |  |  |  |  |
| EVENT |  |  |  |  |
| BOARD | Debug Clock | PA20 | J101_16 |  |
| BOARD | Debug Data In Out | PA19 | J101_14 |  |

## BoosterPacks, Board Resources & Jumper Settings

Visit [LP_MSPM0G5187](https://www.ti.com/tool/LP-MSPM0G5187) for LaunchPad information, including user guide and hardware files.

| Pin | Peripheral | Function | LaunchPad Pin | LaunchPad Settings |
| --- | --- | --- | --- | --- |
| PA17 | GPIOA | PA17 | J12_1 | <ul><li>PA17 can be connected to LED2 Red <ul><li>`J12 ON` Connect to LED2 Red <li>`J12 OFF` Disconnect from LED2 Red</ul></ul> |
| PA24 | GPIOA | PA24 | J13_1 | <ul><li>PA24 can be connected to LED2 Green <ul><li>`J13 ON` Connect to LED2 Green <li>`J13 OFF` Disconnect from LED2 Green</ul></ul> |
| PB13 | GPIOB | PB13 | J11_1 | <ul><li>PB13 can be connected to LED2 Blue <ul><li>`J11 ON` Connect to LED2 Green <li>`J11 OFF` Disconnect from LED2 Green</ul></ul> |
| PA20 | DEBUGSS | SWCLK | N/A | <ul><li>PA20 is used by SWD during debugging<br><ul><li>`J101 15:16 ON` Connect to XDS-110 SWCLK while debugging<br><li>`J101 15:16 OFF` Disconnect from XDS-110 SWCLK if using pin in application</ul></ul> |
| PA19 | DEBUGSS | SWDIO | N/A | <ul><li>PA1

### Device Migration Recommendations
This project was developed for a superset device included in the MSPM0 LaunchPad. Please
visit the [CCS User's Guide](https://software-dl.ti.com/msp430/esd/MSPM0-SDK/latest/docs/english/tools/ccs_ide_guide/doc_guide/doc_guide-srcs/ccs_ide_guide.html#sysconfig-project-migration)
for information about migrating to other MSPM0 devices.

### Low-Power Recommendations
TI recommends to terminate unused pins by setting the corresponding functions to
GPIO and configure the pins to output low or input with internal
pullup/pulldown resistor.

SysConfig allows developers to easily configure unused pins by selecting **Board**â†’**Configure Unused Pins**.

For more information about jumper configuration to achieve low-power using the
MSPM0 LaunchPad, please visit the LP-MSPM0G5187 User's Guide.

## Example Usage
Compile, load and run the example.
Enable any one of the test data provided
The corresponding LED will illuminate to indicate the classified waveform type:
1. Red LED : +fridge
2. Blue LED : +fridge+tumble_dryer+washer_dryer
3. Green LED : +fridge+washing_machine+washer_dryer

Note: The model was trained and tested exclusively with limited test Data. Performance with new test data or real time data may not be accurate.

## References

- MSPM0G5187 Technical Reference Manual [Link](https://www.ti.com/product/MSPM0G5187)
- [TI Neural Network Compiler Guide](https://software-dl.ti.com/mctools/nnc/mcu/users_guide/)
- TI Model Training Guide: [tinyml-tensorlab](https://github.com/TexasInstruments/tinyml-tensorlab/tree/main)
- EdgeAI Software Guide: SDK_INSTALL_DIR/docs/english/middleware/edgeAI/MSPM0_EdgeAI_User_Guide.html